Chef John's Ricotta Pie
2 cups all-purpose flour ½ cup cold butter, cut into chunks 1 large egg 2 tablespoons Marsala wine 1 tablespoon white sugar (Optional) 1 teaspoon baking powder ¼ teaspoon fine salt 2 tablespoons ice water, or as needed (Optional) 3 cups whole-milk ricotta cheese 4 large eggs ⅓ cup white sugar (Optional) 2 large egg yolks 1 ½ teaspoons vanilla extract ½ teaspoon lemon zest, or more to taste ½ teaspoon orange zest, or more to taste (Optional) 1 pinch salt 2 tablespoons semisweet chocolate chips (Optional) 2 tablespoons diced candied orange peel (Optional) ¼ cup white sugar (Optional) ¼ cup water (Optional) ¼ cup chopped orange zest, or to taste (Optional) ¼ cup crushed pistachios, or to taste (Optional) 